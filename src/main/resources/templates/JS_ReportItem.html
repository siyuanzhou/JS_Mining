<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head
        +>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Creative - Bootstrap 3 Responsive Admin Template">
    <meta name="author" content="GeeksLabs">
    <meta name="keyword" content="Creative, Dashboard, Admin, Template, Theme, Bootstrap, Responsive, Retina, Minimal">

    <title>简报生成</title>

    <script src="https://cdn.bootcss.com/echarts/4.2.1-rc1/echarts.min.js"></script>
    <!--jquery加载要放在Bootstrap之前-->
    <script src="https://cdn.bootcss.com/popper.js/1.14.7/umd/popper.min.js"></script>
    <script type="text/javascript" src="./js/report_upload/jquery.min.js"></script>
    <script type="text/javascript" src="./js/report_upload/bootstrap.min.js" charset="utf-8"></script>
    <script type="text/javascript" src="./js/report_upload/bootbox.min.js"></script>
    <script type="text/javascript" src="./js/report_upload/bootstrap-select.min.js"></script>
    <script type="text/javascript" src="./js/report_upload/defaults-zh_CN.min.js"></script>
    <link rel="stylesheet" type="text/css" href="./css/report_upload/style.css">
    <link rel="stylesheet" href="./css/report_upload/bootstrap-select.min.css">

    <link href="../css/bootstrap/bootstrap.min.css" rel="stylesheet">
    <script src="../js/bootstrap/bootstrap.min.js"></script>

    <!--external css-->
    <!--加载等待样式-->
    <link rel="stylesheet" type="text/css" href="./css/report_upload/loadingbutton.css">
    <!-- font icon -->
    <link href="../contrast/css/elegant-icons-style.css" rel="stylesheet"/>
    <link href="../contrast/css/font-awesome.min.css" rel="stylesheet"/>

    <link rel="stylesheet" href="../contrast/css/fullcalendar.css">
    <link href="../contrast/css/widgets.css" rel="stylesheet">
    <!--    <link href="../contrast/css/style.css" rel="stylesheet">-->
    <link href="../contrast/css/style-responsive.css" rel="stylesheet"/>
    <link href="../contrast/css/xcharts.min.css" rel=" stylesheet">
    <link href="../contrast/css/jquery-ui-1.10.4.min.css" rel="stylesheet">


    <!--旭日图所需script文件-->
    <script src="https://code.highcharts.com.cn/highcharts/highcharts.js"></script>
    <script src="https://code.highcharts.com.cn/highcharts/modules/exporting.js"></script>
    <script src="https://code.highcharts.com.cn/highcharts/modules/sunburst.js"></script>
    <script src="https://code.highcharts.com.cn/highcharts/modules/series-label.js"></script>
    <script src="https://code.highcharts.com.cn/highcharts/modules/oldie.js"></script>
    <script src="https://code.highcharts.com.cn/highcharts-plugins/highcharts-zh_CN.js"></script>
    <script src="https://code.highcharts.com.cn/highcharts/modules/annotations.js"></script>
    <script src="https://code.highcharts.com.cn/highcharts/modules/wordcloud.js"></script>

    <!--字体样式-->
    <link rel="stylesheet" type="text/css" href="./css/common_css/zzsc-demo.css">
    <link rel='stylesheet prefetch' href='./css/common_css/normalize.css'>
    <link rel="stylesheet" href="./css/common_css/style.css" media="screen" type="text/css"/>
    <link rel="stylesheet" type="text/css" href="./css/common_css/font-awesome.min.css">

    <style>
        * {
            touch-action: pan-y;
        }

        #tb th {
            font-size: 18px;
        }

        span.second-block {
            font-size: 20px;
            /*margin-left: 0.5em;*/
        }

        .first-block {
            font-family: "微软雅黑 Light";
            font-size: 20px;
            font-weight: 600;
        }

        h1 {
            font-weight: bold;
        }
    </style>
</head>
<body style="background-color: inherit;color: #0f0f0f">

<div th:insert="~{JS_Common::topbar}"></div>
<div style="display: flex;">
    <div th:insert="~{JS_Common::leftbar}"></div>
    <div style="display: block;width:100%">
        <!-- container section start -->
        <section id="container" class="">

            <!--<h1 style="text-align: center">文本分类</h1>-->
            <div class="container">
                <!--style="padding-left: 50px;height:1000px;display: flex;flex-direction: column;width:100%;overflow-y: auto"-->
                <div class="panel panel-primary">
                    <div id="head" class="panel-heading"
                         style="text-align: center;font-family: 华光准圆_CNKI;font-weight: 500;font-size: 38px">
                        <!--                        <h1 id="head" style="text-align: center;width: 1000px;color: #0f0f0f;font-family: 华光准圆_CNKI;font-weight: 800"></h1>-->
                    </div>
                    <!--加载等待框-->
                    <!--<div id="loading" style="display: inline-flex;margin-left: 40%;margin-top: 25px">-->
                    <div id="loading"
                         style="display: inline-flex;margin-left: 40%;margin-top: 25px;margin-bottom: 25px">
                        <div style="font-size: 20px;">正在加载中</div>
                        <div id="fountainG">
                            <div id="fountainG_1" class="fountainG"></div>
                            <div id="fountainG_2" class="fountainG"></div>
                            <div id="fountainG_3" class="fountainG"></div>
                            <div id="fountainG_4" class="fountainG"></div>
                            <div id="fountainG_5" class="fountainG"></div>
                            <!--                    <div id="fountainG_6" class="fountainG"></div>
                                                <div id="fountainG_7" class="fountainG"></div>
                                                <div id="fountainG_8" class="fountainG"></div>-->
                        </div>
                    </div>

                    <div style="height:800px;padding-top: 250px;border: #0C0C0C solid 1px;">
                        <h1 align="center" id="封面标题"></h1>
                        <div style="width: 100%;margin-top: 80px">
                            <div style="display: flex;width:400px;margin:auto;">
                                <div style="width: 300px;text-align: left;">
                                    <span class="first-block">领域:</span>
                                    <span class="second-block"><a id="fscope"></a></span>
                                </div>
                                <div style="width: 300px;text-align: left;">
                                    <span class="first-block" style="width: 300px;text-align: left">国家:</span>
                                    <span class="second-block"><a id="country"></a></span>
                                </div>
                            </div>

                        </div>
                        <div style="width: 100%;margin-top: 30px">
                            <div style="display: flex;width:400px;margin:auto;">
                                <div style="width: 300px;text-align: left">
                                    <span class="first-block" style="width: 300px;text-align: left">开始日期:</span>
                                    <span class="second-block"><a id="start"></a></span>
                                </div>
                                <div style="width: 300px;text-align: left">
                                    <span class="first-block" style="width: 300px;text-align: left">结束日期:</span>
                                    <span class="second-block"><a id="end"> </a></span>
                                </div>
                            </div>
                        </div>


                    </div>

                    <!--目录-->
                    <div style="height:1000px;border: #0C0C0C solid 1px;display: block;line-height: 4em">
                        <h1 style="margin-top: 100px" align="center">目录</h1>

                        <div style="color:dodgerblue;margin-left: 500px;font-size: 20px;margin-top:80px">
                            <div>
                                <a href="javascript:void(0)">（1）目录</a>
                            </div>
                            <div>
                                <a href="#摘要">（2）摘要</a>
                            </div>
                            <div>
                                <a href="#报告说明">（3）报告说明</a>
                            </div>
                            <div id="reportitems">
                                <div>
                                    <a href="#概述篇">（4）概述篇</a>
                                </div>
                                <div>
                                    <a href="#对比篇">（5）对比篇</a>
                                </div>
                                <div>
                                    <a href="#预测篇">（6）预测篇</a>
                                </div>
                            </div>
                        </div>

                    </div>

                    <!--摘要-->
                    <div id="摘要" style="height:1000px;border: #0C0C0C solid 1px;">
                        <h1 style="margin-top: 100px;font-weight: bold" align="center">摘要</h1>
                        <div style="margin-left: 150px;margin-right: 150px;text-indent: 2em;line-height: 2em">

                            <p>本报告以 AI 赋能的<span
                                    class="领域"></span>为核心，在梳理<span class="领域"></span>概念特征、发展历程、
                                工作原理以及系统架构的基础上，重点研究分析了<span class="领域"></span>领域的具体应用情况、领域专家人才现状、典型产品的资源覆盖和功能特色，以及
                                自然语言处理的未来发展趋势。本研究报告基于海量论文、新闻、专利以及网站数据对<span class="领域"></span>这一领域进行了简单梳理，包括以下内容：
                            </p>
                            <p>
                                (1)报告说明:本节通过统计该领域论文的历年发表量，展示出该领域技术的不同时期的发展情况。
                            </p>
                            <p>
                                (2)整体概况:本节通过统计该领域论文的历年发表量，展示出该领域技术的不同时期的发展情况。
                            </p>
                            <p>
                                (3)实力对比:本节详细分析了<span class="领域"></span>在各个国家的历年发展情况，总体排行，国家合作，各国研究机构，使读者能够深入了解不同国家的技术优势。
                            </p>
                            <p>
                                (4)趋势预测:对该技术从历年发展趋势，当前发展定位，以及论文产出、技术成果等方面，对<span class="领域"></span>技术进行相关的分析介绍，同时推荐一些在该领域具有代表性的文章。
                            </p>

                        </div>
                    </div>

                    <!--报告说明-->
                    <div id="报告说明" style="height:1000px;border: #0C0C0C solid 1px;color: #fd7e14;line-height: 2em;">
                        <div style="margin-left: 150px;margin-right: 150px">
                            <h1 style="margin-top: 100px" align="center">报告说明</h1>
                            <h2>数据来源</h2>
                            <div style="text-indent: 2em">
                                <p>基于<span class="领域"></span>领域的论文</p>
                                <p>关于<span class="领域"></span>领域的权威网站。</p>
                            </div>
                            <h2>研究方法</h2>
                            <div style="text-indent: 2em">
                                <p>通过 AMiner 大数据平台对2018 - 2020论文数据
                                    进行挖掘，基于<span class="领域"></span>相关的关键词检索式与期刊，再辅以国家、机构、学者、省份、中英文等条件进一步筛选过滤
                                    挖掘出所有相关论文。然后，基于这些论文，进行如下的进一步挖掘分析:</p>
                                <p>
                                    本节详细分析了<span class="领域"></span>在各个国家的历年发展情况，总体排行，国家合作，各国研究机构，使读者能够深入了解不同国家的技术优势。</p>
                                <p>
                                    对该技术从历年发展趋势，当前发展定位，以及技术热点与技术关联交叉等方面，对<span class="领域"></span>技术进行相关的分析介绍，同时推荐一些在该领域具有代表性的文章。
                                </p>
                            </div>
                        </div>
                    </div>

                    <!--概述篇-->
                    <div id="概述篇" style="height:1000px;border: #0C0C0C solid 1px">
                        <h1 style="margin-top: 100px" align="center">概述篇</h1>
                        <div style="margin-right: 100px;margin-left: 100px;">
                            <p style="color: black"><span
                                    style="color: #2759c2;font-weight:bold;margin-left: 30px">关键信息：</span>
                            <div id="summary" style="line-height:1.8em;color: #0f0f0f;padding-left: 30px"></div>
                            </p>
                            <table id="tb" class="table" hidden>
                                <thead>
                                <tr>
                                    <th style="width: 100px">文章ID</th>
                                    <th style="width: 100px">文章标题</th>
                                    <th style="width: 500px">文章内容</th>
                                    <th style="width: 500px">文章摘要</th>
                                </tr>
                                </thead>
                                <tbody id="tbody" style="vertical-align: center">

                                </tbody>
                            </table>
                            <p style="color: black;margin: 30px"><span
                                    style="color: #2759c2;font-weight:bold">关键词：</span>
                                <a id="keywords" style="color: #0f0f0f;font-weight: 700;"></a>
                            </p>
                            <span style="color: #2759c2">  </span>
                            <!--词云-->
                            <div class="row" style="margin: 30px;">
                                <div id="img1"></div>
                            </div>
                        </div>
                    </div>

                    <div id="概述篇2" style="height:1000px;border: #0C0C0C solid 1px">

                        <!--文本分类-->
                        <div class="row" style="margin: 30px;">
                            <div id="detail4"
                                 style="text-indent: 2em;line-height:2em;margin-top:1px;margin-left:1px;font-family: 华光准圆_CNKI">
                            </div>
                            <div class="panel-body" id="classify_div"
                                 style="width: 1000px;height: 400px;margin-left: 70px;">
                            </div>
                        </div>

                        <!--实体、关系展示-->
                        <div class="row" style="margin: 70px;">
                            <div class="panel panel-default">
                                <p id="introduce" style="text-indent: 2em;line-height:2em;font-family: 华光准圆_CNKI;"></p>
                                <!-- <div class="panel-heading" style="text-align: center">关键实体</div>-->
                                <div id="first_div" class="panel-body"
                                     style="padding-left:90px;width:1000px;height: 420px;border: 0px">
                                </div>
                            </div>
                        </div>

                    </div>

                    <!--对比篇-->
                    <div id="对比篇" style="height:1000px;border: #0C0C0C solid 1px">
                        <h1 style="margin-top: 100px" align="center">对比篇</h1>

                        <!--对比分析选项-->
                        <div class="row" style="margin-left: 100px;margin-right: 100px;margin-top: 30px">
                            <div class='col-sm-3'>
                                <div class="form-group">
                                    <label>国家:</label>
                                    <select id="dcountry" class="form-control select_down selectpicker" multiple
                                            data-live-search="true" title="请选择国家">
                                        <option value="中国">中国</option>
                                        <option value="美国">美国</option>
                                        <option value="英国">英国</option>
                                        <option value="法国">法国</option>
                                        <option value="俄罗斯">俄罗斯</option>
                                        <option value="德国">德国</option>
                                        <option value="印度">印度</option>
                                        <option value="加拿大">加拿大</option>
                                        <option value="澳大利亚">澳大利亚</option>
                                        <option value="韩国">韩国</option>
                                        <option value="瑞士">瑞士</option>
                                        <option value="以色列">以色列</option>
                                        <option value="爱尔兰">爱尔兰</option>
                                        <option value="瑞典">瑞典</option>
                                    </select>
                                </div>
                            </div>
                            <div class='col-sm-3'>
                                <div class="form-group">
                                    <label>领域</label>
                                    <select id="dlingyu" class="form-control select_down"
                                            style="font-size: 13px; color: #666;">
                                        <option name="d自然语言处理">自然语言处理</option>
                                        <option name="d计算机视觉">计算机视觉</option>
                                        <!--  <option name="dAI计划与应用">AI计划与应用</option>-->
                                        <option name="d机器人技术">机器人技术</option>
                                        <option name="d优化算法理论">优化算法理论</option>
                                        <option name="d语音识别">语音识别</option>
                                        <option name="d个性化推荐">个性化推荐</option>
                                    </select>
                                </div>
                            </div>
                            <div class='col-sm-3'>
                                <div class="search_input" style="margin-top: 30px">
                                    <button class="btn btn-primary search_btn" type="button" id="duibi">实力对比</button>
                                </div>
                            </div>
                        </div>

                        <!--旭日图实力对比-->
                        <div class="row" style="margin-left: 100px;margin-right: 100px;margin-top: 30px">
                            <div id="detail1"
                                 style="display:inline-block;text-indent:2em;line-height:2em;font-family: 华光准圆_CNKI;">
                            </div>
                            <div class="panel panel-default">
                                <div class="panel-body" id="sunshine" style="margin: auto;width: 600px;height: 600px;">
                                </div>
                            </div>

                        </div>

                    </div>

                    <div id="对比篇2" style="height:1000px;border: #0C0C0C solid 1px">
                        <!--科技实力折线图对比-->
                        <div id="detail2"
                             style="display:inline-block;text-indent:2em;line-height:2em;font-family: 华光准圆_CNKI;margin-left: 100px;margin-right: 100px;margin-top: 50px">
                        </div>
                        <div class="row" style="margin-left: 100px;margin-right: 100px;margin-top: 50px">
                            <div class="panel-body" id="serialsLabel"
                                 style="width: 800px;height: 350px;margin-left: 100px">
                            </div>
                            <div class="panel-body" id="serialsLabel2"
                                 style="width: 800px;height: 350px;margin-left: 100px">
                            </div>
                        </div>
                    </div>

                    <!--预测篇-->
                    <div id="预测篇" style="height:1000px;border: #0C0C0C solid 1px">
                        <h1 style="margin-top: 100px" align="center">预测篇</h1>

                        <!--预测选项-->
                        <div class="row" style="margin-left: 100px;margin-right: 100px;margin-top: 50px">
                            <div class='col-sm-3'>
                                <div class="form-group">
                                    <label>国家:</label>
                                    <select id="pcountry" class="form-control select_down" title="请选择国家">
                                        <option value="中国">中国</option>
                                        <option value="美国">美国</option>
                                        <option value="英国">英国</option>
                                        <option value="法国">法国</option>
                                        <option value="俄罗斯">俄罗斯</option>
                                        <option value="德国">德国</option>
                                        <option value="印度">印度</option>
                                        <option value="加拿大">加拿大</option>
                                        <option value="澳大利亚">澳大利亚</option>
                                        <option value="韩国">韩国</option>
                                        <option value="瑞士">瑞士</option>
                                        <option value="以色列">以色列</option>
                                        <option value="爱尔兰">爱尔兰</option>
                                        <option value="瑞典">瑞典</option>
                                    </select>
                                </div>
                            </div>
                            <div class='col-sm-3'>
                                <div class="form-group">
                                    <label>范围</label>
                                    <select id="psecondScope" class="form-control select_down"
                                            style="font-size: 13px; color: #666;">
                                        <option name="p自然语言处理">自然语言处理</option>
                                        <option name="p计算机视觉">计算机视觉</option>
                                        <option name="p语音识别">语音识别</option>
                                        <option name="p机器人技术">机器人技术</option>
                                        <option name="p优化算法理论">优化算法理论</option>
                                        <option name="p语音识别">语音识别</option>
                                        <option name="p个性化推荐">个性化推荐</option>
                                    </select>
                                </div>
                            </div>
                            <div class='col-sm-3'>
                                <div class="search_input" style="margin-top: 30px">
                                    <button class="btn btn-primary search_btn" type="button" id="yuce">趋势预测</button>
                                </div>
                            </div>

                        </div>
                        <!--趋势预测-->
                        <div class="row" style="margin-left: 100px;margin-right: 100px;margin-top: 50px">
                            <div id="detail5"
                                 style="text-indent: 2em;line-height:2em;margin-top:1px;margin-left:1px;font-family: 华光准圆_CNKI">
                            </div>
                            <div class="panel-body" id="predict_div2"
                                 style="width: 1000px;height: 500px;margin-left: 50px;">
                            </div>
                        </div>

                    </div>

                    <div id="预测篇2" style="height:1000px;border: #0C0C0C solid 1px">
                        <!--趋势预测-技术突袭-->
                        <div class="row" style="margin-left: 100px;margin-right: 100px;margin-top: 50px">
                            <div id="detail3"
                                 style="text-indent: 2em;line-height:2em;margin-top:1px;margin-left:1px;font-family: 华光准圆_CNKI">
                            </div>
                            <div class="panel-body" id="predict_div"
                                 style="width: 1000px;height: 500px;margin-left: 50px;">
                            </div>
                        </div>

                    </div>


                    <!-- Table -->
                    <table class="table">
                        ...
                    </table>

                </div>

            </div>
        </section>
    </div>

    <!--main content end-->
    <!-- container section start -->
</div>

<!--右键菜单定义-->
<div id="popupRC" style="display:none;" class="panel panel-primary  ">
    <div class="panel-heading" style="background-color: #F1F1F1;">
        <a href="javascript:txt2img(getSelectionText())">多模态检索图片</a>
    </div>
    <div class="panel-body" id="showImg">
        <!-- <div class="form-group">
            <label class="control-label col-md-2">Color</label>

            <input type="color" class="form-control" id="idcolorr" />
        </div> -->
        <div style="display: flex;flex-direction: row">

        </div>
    </div>
    <div class="panel-footer"><input type="button" class="btn btn-danger" value="关闭" onClick="closeMenu()"/></div>
</div>
</div>
<!-- javascripts -->
<script src="../contrast/js/jquery.js"></script>

<script>
    var start = localStorage.getItem("start");
    var end = localStorage.getItem("end");
    var firstScope = localStorage.getItem("firstScope");
    var country = localStorage.getItem("country");
    // var secondScope = localStorage.getItem("secondScope");
    var source = localStorage.getItem("source");
    var text_data = localStorage.getItem("text_data");
    var articles = localStorage.getItem("articles");
    console.log(articles);
    var countrys = country.split(",");
    var random = localStorage.getItem("random");
    var select_area = "";
    var reportItems = localStorage.getItem("reportItems").split(",");

    nextChange(firstScope);

    <!--右键菜单多模态检索图片相关-->
    function getSelectionText() {
        if (window.getSelection) {
            return window.getSelection().toString();
        } else if (document.selection && document.selection.createRange) {
            return document.selection.createRange().text;
        }
        return '';
    }

    function txt2img(input) {
        $.ajax({
            url: "http://127.0.0.1:2346/txt2img",
            method: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(input),
            success: function (data) {
                // fill the html for answer
                var array = data['output'];
                // alert(array[0][0]);
                if (array.length === 0) {
                    $("#showImg").append("目前未检索到相似结果");
                }
                for (var i = 0; i < array.length / 2; i++) {
                    // $('#menu').append('          <div class="col-sm-6 col-md-3">\n' +
                    //     '                <div class="thumbnail">\n' +
                    //     '                  <img src='+array[i][0]+' alt="...">\n' +
                    //     '                  <div class="caption">\n' +
                    //     '                    <p><b>武器介绍</b></p>\n' +
                    //     '                    <p>'+array[i][1]+'</p>\n' +
                    //     '                  </div>\n' +
                    //     '                </div>\n' +
                    //     '          </div>');
                    $('#showImg').append("<div style=\"display: flex;flex-direction: row\">\n" +
                        "                <img style='width: 180px;height: 120px' src=\"" + array[i * 2][0] + "\">\n" +
                        "                <img style='width: 180px;height: 120px' src=\"" + array[i * 2 + 1][0] + "\">\n" +
                        "            </div>");
                }
            },
            error: function (jqXhr, textStatus, errorThrown) {
                console.log(errorThrown);
            },
            timeout: 200000 // sets timeout to 10 seconds
        });
    }

    function closeMenu() {
        $('#popupRC').css({display: 'none'});
        $('#showImg').html("");
    }

    //点击按钮隐藏或者显示table
    function toggleTable() {
        $("#tb").toggle();
    }

    $(function () {
        $("#container").bind('contextmenu', function (e) {
            e.preventDefault(); // prevents default menu
            $("#popupRC").css({position: "fixed", top: e.screenY - 50, left: e.screenX, display: "block"});
        });
        $(".panel-heading").hide()
        $(".panel-body").hide()
    });

    function nextChange(field) {
        var first = field;
        var second = document.getElementById("dlingyu");
        second.options.length = 0; // 清除second下拉框的所有内容
        if (first == "人工智能") {
            second.options.add(new Option("自然语言处理", "自然语言处理"));
            /*second.options.add(new Option("AI计划与应用", "AI计划与应用"));*/
            second.options.add(new Option("机器人技术", "机器人技术"));
            second.options.add(new Option("优化算法理论", "优化算法理论"));
            second.options.add(new Option("个性化推荐", "个性化推荐"));
            second.options.add(new Option("语音识别", "语音识别"));
            second.options.add(new Option("计算机视觉", "计算机视觉", false, true));  // 默认选中区
        } else if (first == "网络攻防") {
            second.options.add(new Option("网络攻防", "网络攻防", false, true));  // 默认选中区
        }

        var second2 = document.getElementById("psecondScope");
        second2.options.length = 0; // 清除second下拉框的所有内容
        if (first == "人工智能") {
            second2.options.add(new Option("自然语言处理", "自然语言处理"));
            /*second2.options.add(new Option("AI计划与应用", "AI计划与应用"));*/
            second2.options.add(new Option("机器人技术", "机器人技术"));
            second2.options.add(new Option("优化算法理论", "优化算法理论"));
            second2.options.add(new Option("个性化推荐", "个性化推荐"));
            second2.options.add(new Option("语音识别", "语音识别"));
            second2.options.add(new Option("计算机视觉", "计算机视觉", false, true));  // 默认选中区
        } else if (first == "网络攻防") {
            second.options.add(new Option("网络攻防", "网络攻防", false, true));  // 默认选中区
        }

    }

    $(function () {

        $("#概述篇").hide();
        $("#概述篇2").hide();
        $("#对比篇").hide();
        $("#对比篇2").hide();
        $("#预测篇").hide();
        $("#预测篇2").hide();

        var catalog = "";
        for (var i = 0; i < reportItems.length; i++) {
            var num = i+4;
            catalog +="<div> <a href=\"#" + reportItems[i] + "\">（" + num + "）" + reportItems[i] + "</a></div>";
        }
        $("#reportitems").html(catalog);

        $("#introduce").html("抽取" + firstScope + "领域相关实体如下：");
        $("#head").html(start.substring(0, 4) + "-" + end.substring(0, 4) + country + firstScope + "领域科技简报");
        $("#fscope").html(firstScope);
        /*$("#sscope").html(firstScope);*/
        $("#country").html(country);
        $("#source").html(source);
        $("#start").html(start);
        $("#end").html(end);
        var countries = country.split(",")
        var one_country = countries[0]

        for (var i = 0; i < countries.length; i++) {
            $("#dcountry option[value='" + countries[i] + "']").attr("selected", "selected")
        }
        // 关键信息
        $.ajax({
            url: "http://127.0.0.1:8000/multiReport",
            method: 'POST',
            dataType: 'jsonp',
            jsonp: "callback",
            jsonpCallback: "successCallback_multireport",//回调方法
            contentType: 'application/json',
            data: {
                'texts': text_data.toString()
            },
            success: function (data) {
                var textsum = data["sumlist"];
                var articleList = JSON.parse(articles)["article"];
                for (var i = 0; i < articleList.length; i++) {
                    $("#tbody").append("<tr>\n" +
                        "                                    <td style='text-align: center;vertical-align: middle'>" + articleList[i]["id"] + "</td>\n" +
                        "                                    <td style='text-align: center;vertical-align: middle'>" + articleList[i]["title"] + "</td>\n" +
                        "                                    <td><div style='overflow-y: auto;height: 200px;text-align: left'>" + articleList[i]["content"] + "</div></td>\n" +
                        "                                    <td style='text-align: center;vertical-align: middle'><div style='overflow-y: auto;height: 200px;display: flex;align-items: center;text-align: justify'>" + textsum[i] + "</div></td>\n" +
                        "                                </tr>");
                }
                $("#summary").html(data['multi_textsum'] + "<a href='javascript:toggleTable()'>点击查看或隐藏详细信息</a>");
            }
        });

        // 关键词
        $.ajax({
            url: "http://127.0.0.1:8888/keywords",
            method: 'POST',
            dataType: 'jsonp',
            jsonp: "callback",
            jsonpCallback: "successCallback_keywords",//回调方法
            contentType: 'application/json',
            data: {
                'text': text_data.toString(),
            },
            success: function (data) {
                console.log(data);
                //alert(JSON.stringify(data));
                //alert(data.keywords);
                var str = "";
                for (var i = 0; i < data.keywords.length; i++) {
                    str += data.keywords[i] + ";"
                }
                $("#keywords").html(str);
                printWordsLabel(data.cloud);
            }
        });

        // 关系图
        $.ajax({
            url: "http://127.0.0.1:8888/api",
            method: 'POST',
            dataType: 'jsonp',
            jsonp: "callback",
            jsonpCallback: "successCallback_api",//回调方法
            contentType: 'application/json',
            data: {input: JSON.stringify(text_data)},

            success: function (data) {
                var str1 = data.input;
                var entityMap = data.listDemo;
                var raw_relations = data.raw_relations;
                var datas = raw_relations[0];
                var links = raw_relations[1];
                showRela(datas, links);
                console.log(str1);
            },
            error: function (jqXhr, textStatus, errorThrown) {
                console.log(errorThrown);
            }
        });

        // 文本分类
        $.ajax({
            url: "http://127.0.0.1:7000/classify",
            method: 'POST',
            dataType: 'jsonp',
            jsonp: "callback",
            jsonpCallback: "successCallback_classify",//回调方法
            contentType: 'application/json',
            data: {input: JSON.stringify(text_data)},
            success: function (data) {
                showType(data);
                console.log(data);
                var max = data.probability[0]
                var maxIndex = 0
                for (var i = 0; i < data.probability.length - 1; i++) {
                    maxIndex = max < data.probability[i + 1] ? i + 1 : maxIndex
                    max = max < data.probability[i + 1] ? data.probability[i + 1] : max
                }
                var field_classified_CN = data.classify[maxIndex] // field_classified 是 中文
                console.log('max:' + max);
                console.log('maxIndex:' + maxIndex);
                console.log('field_classified:' + field_classified_CN);

                $("#封面标题").html(field_classified_CN + "技术简报")
                $(".领域").html(field_classified_CN)

                if (reportItems.includes("概述篇")) {
                    $("#概述篇").show();
                    $("#概述篇2").show();
                }

                $("#dlingyu option[value='" + field_classified_CN + "']").attr("selected", "selected")
                $("#dcountry option[value='" + field_classified_CN + "']").attr("selected", "selected")

                if (reportItems.includes("对比篇")) {
                    $("#对比篇").show();
                    $("#对比篇2").show();
                    duibi_ajax(field_classified_CN, country)         // 对比模块传入的field 为文本分类最大结果，需为中文
                    console.log('firstScope:' + firstScope);
                }

                // if(field_classified_CN == "语音识别" ){
                //     var truefield = "优化算法理论"
                //     var fakefield = "语音识别"
                // }
                // else{
                //     var truefield = fakefield = field_classified_CN
                // }
                $("#psecondScope option[value='" + field_classified_CN + "']").attr("selected", "selected")
                $("#pcountry option[value='" + one_country + "']").attr("selected", "selected")

                if (reportItems.includes("预测篇")) {
                    $("#预测篇").show();
                    $("#预测篇2").show();
                    yuce_ajax(firstScope, field_classified_CN, one_country)              // 预测模块传入的前一页面选择的领域
                }
                $('#loading').hide();
            },
            error: function () {
                console.log("error");
            }
        });

        //数组去重
        function UniqObj(array) {     // 对象去重方法
            var allArr = [];    //建立新的临时数组
            for (var i = 0; i < array.length; i++) {
                var flag = true;
                for (var j = 0; j < allArr.length; j++) {
                    if (array[i].name == allArr[j].name) {
                        flag = false;
                    }
                }
                if (flag) {
                    allArr.push(array[i]);
                }
            }
            return allArr;
        }

        //显示关系图
        function showRela(data, links) {

            var myChart = echarts.init(document.getElementById('first_div'));
            var categories = [];
            for (var i = 0; i < 2; i++) {
                categories[i] = {
                    name: '类目' + i
                };
            }
            option = {
                series: [{
                    type: 'graph', // 类型:关系图
                    layout: 'force', //图的布局，类型为力导图
                    symbolSize: 50, // 调整节点的大小
                    roam: true, // 是否开启鼠标缩放和平移漫游。默认不开启。如果只想要开启缩放或者平移,可以设置成 'scale' 或者 'move'。设置成 true 为都开启
                    edgeSymbol: ['circle', 'arrow'],
                    edgeSymbolSize: [2, 10],
                    edgeLabel: {
                        normal: {
                            textStyle: {
                                fontSize: 20
                            }
                        }
                    },
                    force: {
                        repulsion: 250,
                        edgeLength: [100, 150]
                    },
                    draggable: true,
                    lineStyle: {
                        normal: {
                            width: 2,
                            color: '#4b565b'
                        }
                    },
                    edgeLabel: {
                        normal: {
                            show: true,
                            formatter: function (x) {
                                return x.data.name;
                            }
                        }
                    },
                    label: {
                        normal: {
                            show: true,
                            textStyle: {}
                        }
                    },
                    categories: categories
                }]
            };
            var tmp = option.series;
            tmp[0]['data'] = UniqObj(data);
            tmp[0]['links'] = links;
            // console.log(tmp[0]['data'],tmp[0]['links']);
            myChart.setOption(option);
        }

    });

    // 提交所需参数给后端，并绘制对比图
    function duibi_ajax(field, country) {
        var countries = country.split(",")
        $.ajax({
            url: "http://127.0.0.1:7450/detail",
            method: 'POST',
            dataType: 'jsonp',
            jsonp: "callback",
            jsonpCallback: "successCallback_detail",//回调方法
            contentType: 'application/json',
            data: {
                'field_name': field,
                'country_list': JSON.stringify(countries),
                'start_year': start.substring(0, 4),
                'end_year': end.substring(0, 4),
            },
            success: function (data) {
                console.log(data);
                var info = JSON.parse(data);
                $("#detail1").html(info.before_pic);
                $("#detail2").html(info.after_pic);
                $.ajax({
                    url: "http://127.0.0.1:7450/sunburst",
                    method: 'POST',
                    dataType: 'jsonp',
                    jsonp: "callback",
                    jsonpCallback: "successCallback_sunburst",//回调方法
                    contentType: 'application/json',
                    data: {
                        'field_name': field,
                        'country_list': JSON.stringify(countries),
                        'start_year': start.substring(0, 4),
                        'end_year': end.substring(0, 4),
                        'random': random
                    },
                    success: function (data) {
                        var datas = JSON.parse(data);
                        var arr = [];
                        for (var i = 0; i < datas.length; i++) {
                            var jsonStr = JSON.stringify(datas[i]);       //转为JSON字符串
                            var jsObject = JSON.parse(jsonStr);    //转换为json对象
                            arr.push(jsObject);
                        }
                        printSunShine(arr, field, country);
                    }
                });
            }
        });


        $.ajax({
            url: "http://127.0.0.1:7450/linechart",
            method: 'POST',
            dataType: 'jsonp',
            jsonp: "callback",
            jsonpCallback: "successCallback_LineChart",//回调方法
            contentType: 'application/json',
            data: {
                'field_name': field,
                'country_list': JSON.stringify(countries),
                'start_year': start.substring(0, 4),
                'end_year': end.substring(0, 4),
                'indicator_name': "科技产出",
                'random': random,
            },
            success: function (data) {
                console.log("data=" + data);
                $("#serialsLabel").empty();
                printSerialsLabel(JSON.parse(data), field, country);
            }
        });

        $.ajax({
            url: "http://127.0.0.1:7450/addchart",
            method: 'POST',
            dataType: 'jsonp',
            jsonp: "callback",
            jsonpCallback: "successCallback_addchart",//回调方法
            contentType: 'application/json',
            data: {
                'field_name': field,
                'country_list': JSON.stringify(countries),
                'start_year': start.substring(0, 4),
                'end_year': end.substring(0, 4),
                'indicator_name': "科技产出",
                'random': random,
            },
            success: function (data) {
                console.log("data=" + data);
                $("#serialsLabel2").empty();
                printSerialsLabel2(JSON.parse(data), field, country);
            }
        });
    }

    $("#duibi").click(function () {

        var select_area = $('#dlingyu option:selected').text();//文本
        countrys = $('#dcountry').val().toString();//文本
        duibi_ajax(select_area, countrys)

    });

    // 提交所需参数给后端，并绘制对预测图
    function yuce_ajax(source, field, country) {
        $("#predict_div").empty()
        $("#predict_div2").empty()
        $.ajax({
            url: "http://127.0.0.1:7650/predict",
            method: 'POST',
            dataType: 'jsonp',
            jsonp: "callback",
            jsonpCallback: "successCallback_predict",//回调方法
            contentType: 'application/json',
            data: {
                "field": field,
                "source": source
            },
            success: function (data) {
                console.log("data=" + data);
                data = JSON.stringify(data);
                var predict_data = JSON.parse(data);
                $("#detail3").html(predict_data.text);
                //alert(predict_data.text)
                printPredictLabel(predict_data, field);
                $('#loading').hide();
                $(".panel-body").show();
                $(".panel-heading").show();


                // 趋势预测
                $.ajax({
                    url: "http://127.0.0.1:7005/predict2",
                    method: 'POST',
                    dataType: 'jsonp',
                    jsonp: "callback",
                    jsonpCallback: "successCallback_predict2",//回调方法
                    contentType: 'application/json',
                    data: {
                        "field": field,
                        "country": country,
                    },
                    success: function (data) {
                        console.log("data=" + data);
                        data = JSON.stringify(data);
                        var predict_data = JSON.parse(data);
                        $("#detail5").html(predict_data.text);

                        printPredictLabel2(predict_data, field, country);

                    },
                });
            },
        });


    }

    $("#yuce").click(function () {

        var country = $('#pcountry').val().toString();//文本
        var select_area = $('#psecondScope option:selected').text();//文本
        // if(select_area == "语音识别" ){
        //     var truefield = "优化算法理论"
        //     var fakefield = "语音识别"
        // }
        // else{
        //     var truefield = fakefield = select_area
        // }
        yuce_ajax(firstScope, select_area, country)

    });


    function printWordsLabel(data) {

        var wordChart = Highcharts.chart('img1', {
            series: [{
                type: 'wordcloud',
                data: data,
            }],
            title: {
                text: ''
            }
        });

    }


    // 文本分类图
    var myTypeChart = echarts.init(document.getElementById('classify_div'));

    function showType(data) {
        //echarts表格
        console.log('文本分类返回数据:   ' + data)
        myTypeChart.setOption({
            title: {
                text: '文本分类结果',
                x: 'center',
                y: 'top',
            },
            tooltip: {
                trigger: 'axis',
                axisPointer: {
                    type: 'shadow'
                }
            },
            legend: {
                /*  data: [ '2012年']*/
                x: 'left',
                y: ' top',
                padding: [30, 0, 0, 110],
            },
            // grid: {
            //     left: '3%',
            //     right: '4%',
            //     bottom: '3%',
            //     containLabel: true
            // },
            yAxis: {
                type: 'value',
                boundaryGap: [0, 0.01],
                max: 1.0
            },
            xAxis: {
                type: 'category',
                data: data.classify,
                axisLabel: {
                    interval: 0,
                    rotate: 15,
                    textStyle: {
                        // color: '#000',
                        fontSize: 12
                    },
                },
            },

            series: [{
                name: '文本分类概率分布',
                type: 'bar',
                itemStyle: {
                    normal: {
                        color: '#0b96e5'
                    }
                },
                barWidth: 30,
                data: data.probability,
            }]
        });
        setTimeout(function () {
            window.onresize = function () {
                myTypeChart.resize();
            }
        }, 400)
    }


    // 实力对比折线图
    function printSerialsLabel(data, field, country) {

        console.log("实力对比折线图返回数据=" + data);
        var countries = country.replaceAll(",", "、")
        var serialChart = Highcharts.chart('serialsLabel', {
            credits: {
                enabled: false  //去除highcharts版权信息
            },
            title: {
                text: countries + field + '领域科技实力对比折线图'
            },
            colors: ['#c70831', 'rgba(0,201,66,0.97)', 'rgba(0,171,201,0.97)',
                'rgba(214,229,6,0.97)', 'rgba(118,57,220,0.97)', 'rgba(198,105,35,0.97)'],
            subtitle: {
                text: ''
            },
            yAxis: {
                title: {
                    text: '实力指数'
                }
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'middle'
            },
            plotOptions: {
                series: {
                    label: {
                        connectorAllowed: false
                    },
                    pointStart: parseInt(start.substring(0, 4))
                }
            },

            series: data,
            // responsive: {
            //     rules: [{
            //         condition: {
            //             maxWidth: 500
            //         },
            //         chartOptions: {
            //             legend: {
            //                 layout: 'horizontal',
            //                 align: 'center',
            //                 verticalAlign: 'bottom'
            //             }
            //         }
            //     }]
            // }
        });

    }

    // 实力对比增量折线图
    function printSerialsLabel2(data, field, country) {
        var countries = country.replaceAll(",", "、")
        var serialChart = Highcharts.chart('serialsLabel2', {
            credits: {
                enabled: false  //去除highcharts版权信息
            },
            title: {
                text: countries + field + '领域科技实力增量对比折线图'
            },
            colors: ['#c70831', 'rgba(0,201,66,0.97)', 'rgba(0,171,201,0.97)',
                'rgba(214,229,6,0.97)', 'rgba(118,57,220,0.97)', 'rgba(198,105,35,0.97)'],
            subtitle: {
                text: ''
            },
            yAxis: {
                title: {
                    text: '实力增量'
                }
            },
            legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'middle'
            },
            plotOptions: {
                series: {
                    label: {
                        connectorAllowed: false
                    },
                    pointStart: parseInt(start.substring(0, 4))
                }
            },

            series: data,
            responsive: {
                rules: [{
                    condition: {
                        maxWidth: 500
                    },
                    chartOptions: {
                        legend: {
                            layout: 'horizontal',
                            align: 'center',
                            verticalAlign: 'bottom'
                        }
                    }
                }]
            }
        });

    }

    //旭日图
    function printSunShine(data, field, country) {
        var countries = country.replaceAll(",", "、")
        Highcharts.setOptions({
            lang: {
                thousandsSep: ',',
                turboThreshold: 2000
            }
        });
        Highcharts.getOptions().colors.splice(0, 0, 'transparent');
        Highcharts.chart('sunshine', {
                credits: {
                    enabled: false  //去除highcharts版权信息
                },
                chart: {
                    height: '100%'
                },
                colors: ['#c70831', 'rgba(0,201,66,0.97)', 'rgba(0,171,201,0.97)',
                    'rgba(214,229,6,0.97)', 'rgba(118,57,220,0.97)', 'rgba(198,105,35,0.97)'],
                title: {
                    text: countries + field + '领域综合实力对比'
                },
                series: [{
                    type: "sunburst",
                    data: data,
                    color: 'white',
                    allowDrillToNode: true,
                    cursor: 'pointer',
                    dataLabels: {
                        /**
                         * A custom formatter that returns the name only if the inner arc
                         * is longer than a certain pixel size, so the shape has place for
                         * the label.
                         */
                        formatter: function () {
                            var shape = this.point.node.shapeArgs;

                            var innerArcFraction = (shape.end - shape.start) / (2 * Math.PI);
                            var perimeter = 2 * Math.PI * shape.innerR;

                            var innerArcPixels = innerArcFraction * perimeter;

                            if (innerArcPixels > 16) {
                                return this.point.name;
                            }
                        }
                    },
                    levels: [{
                        level: 2,
                        colorByPoint: true,
                        dataLabels: {
                            rotationMode: 'parallel'
                        }
                    },
                        {
                            level: 3,
                            colorVariation: {
                                key: 'brightness',
                                to: -0.5
                            }
                        }, {
                            level: 4,
                            colorVariation: {
                                key: 'brightness',
                                to: 0.5
                            }
                        }]

                }],
                tooltip: {
                    headerFormat: "",
                    pointFormatter: function () {
                        if (this.name == '0.0') {
                            return country + field + '综合科技实力对比'
                        }
                        return '<b>' + this.name + '</b>的得分为：<b>' + this.value + '</b>'
                    }
                }
            }
        )
    }

    //预测-技术成熟度
    function printPredictLabel(data, field) {

        // console.log(typeof data);
        var result = [];
        var push1 = {};
        push1["name"] = "历史数据";
        var data_history = Array.prototype.slice.call(data.history);
        var warn_point = data_history.pop();
        data_history.push({y: warn_point, id: 'warn'});
        push1["data"] = data_history;
        var push2 = {};
        push2["name"] = "预测数据";
        push2["data"] = data.predict;
        var push3 = {};
        push3["name"] = "diff";
        push3["data"] = data.diff;
        result.push(push2);
        result.push(push1);
        result.push(push3);
        console.log("resultData=" + result);
        console.log("技术成果=" + data.技术成果);

        var max = data.技术成果[0]
        var maxIndex = 0
        for (var i = 0; i < data.技术成果.length - 1; i++) {
            maxIndex = max < data.技术成果[i + 1] ? i + 1 : maxIndex
            max = max < data.技术成果[i + 1] ? data.技术成果[i + 1] : max
        }

        var max2 = data.diff[0]
        var maxIndex2 = 0
        for (var i = 0; i < data.diff.length - 1; i++) {
            maxIndex2 = max2 < data.diff[i + 1] ? i + 1 : maxIndex2
            max2 = max2 < data.diff[i + 1] ? data.diff[i + 1] : max2
        }

        var serialChart = Highcharts.chart('predict_div', {
            credits: {
                enabled: false  //去除highcharts版权信息
            },
            title: {
                text: field + '技术成熟度分析图'
            },
            subtitle: {
                text: ''
            },
            colors: ['rgba(1,45,101,0.74)', '#c70831', 'rgba(0,201,66,0.97)', 'rgba(81,22,146,0.97)', 'rgba(0,171,201,0.97)'],
            yAxis: [{
                title: {
                    // text: '技术成熟度',
                    enabled: false
                },
                labels: {
                    enabled: false
                },
            }, {
                title: {
                    text: '论文增长量',
                    style: {},
                },
                labels: {
                    style: {},
                },
            }, {
                title: {
                    text: '技术成果',
                    style: {},

                },
                labels: {
                    style: {},
                },
                opposite: true
            },],
            //x轴分四个阶段用不同背景颜色表示
            xAxis: [{
                labels: {
                    rotation: -30
                },
                tickPositions: [1960, 1970, 1980, 1990, 2000, 2010, 2020, 2030, 2040, 2050, 2060, (1958 + data.发展期), (1958 + data.成熟期)],
                plotBands: [
                    { //彩色带横跨绘图区，标志着轴间隔。
                        color: 'rgba(201,236,206,0.88)',
                        from: 1958,
                        to: 1958 + data.萌芽期,
                        label: {
                            text: '萌芽期'
                        },
                        zIndex: 1
                    },
                    { //彩色带横跨绘图区，标志着轴间隔。
                        color: 'rgb(238,245,197)',
                        from: 1958 + data.萌芽期,
                        to: 1958 + data.发展期,
                        label: {
                            text: '发展期'
                        },
                        zIndex: 1
                    },
                    { //彩色带横跨绘图区，标志着轴间隔。
                        color: 'rgba(253,137,137,0.83)',
                        from: 1958 + data.发展期,
                        to: 1958 + data.突袭期,
                        label: {
                            text: '突袭期'
                        },
                        zIndex: 1
                    },

                    { //彩色带横跨绘图区，标志着轴间隔。
                        color: 'rgba(219,198,236,0.82)',
                        from: 1958 + data.突袭期,
                        to: 3000,
                        label: {
                            text: '成熟期'
                        },
                        zIndex: 0
                    },
                ],
                // 突袭期起点和终点两条标线
                // plotLines:[{
                //     color:'#ff0000',
                //     dashStyle:'dash',
                //     value: 1958 + data.发展期,
                //     width:6,
                //     zIdenx: 99999
                //
                // },{
                //     color:'#ff0000',
                //     dashStyle:'dash',
                //     value: 1958 + data.成熟期,
                //     width:6,
                //     zIdenx: 99999
                //
                // }],
            },],
            plotOptions: {
                series: {
                    label: false,
                    pointStart: 1958
                }
            },
            series: [{
                type: 'scatter',
                name: '技术发展',
                data: data_history,
                zIndex: 6,
                marker: {
                    enable: true,
                    radius: 2,
                }
            }, {
                name: '技术生命周期',
                data: data.predict,
                zIndex: 6,

            }, {
                name: '论文增长量',
                data: data.diff,
                zIndex: 5,
                yAxis: 1
            }, {
                name: '论文产出',
                data: data.论文产出,
                zIndex: 5,
                yAxis: 1
            }, {
                name: '技术成果',
                data: data.技术成果,
                // type: 'column',
                yAxis: 2,
                zIndex: 0,
                // marker:{
                //     enabled: true,
                //     // symbol: 'square'
                // }
            },
                //     {
                //     name: '预警点',
                //     data: [{x: 1958 + data_history.length - 1, y: warn_point}],
                //     showInLegend: false,
                //     marker: {
                //         symbol: 'circle',
                //         radius:5
                //     }
                // },
            ],
            legend: {
                // layout: 'horizontal',
                // align: 'center',
                // verticalAlign: 'bottom'
                layout: 'vertical',
                align: 'left',
                x: 85,
                verticalAlign: 'top',
                y: 55,
                floating: true,
                symbolHeight: 8,
                symbolWidth: 16,
                symbolRadius: 0,
            },
            responsive: {
                rules: [{
                    condition: {
                        maxWidth: 500
                    },
                    chartOptions: {}
                }]
            },
            // 标注
            annotations: [{
                labelOptions: {
                    backgroundColor: 'rgba(255,255,255,0.5)',
                    verticalAlign: 'top',
                    y: 20,
                    x: -100
                },
                labels: [{
                    point: {
                        xAxis: 0,
                        yAxis: 0,
                        x: data.predict.length - 1 + 1958,
                        y: data.predict[data.predict.length - 1],
                    },
                    text: (data.predict.length - 1 + 1958) + '年<br>' + '论文累积量:' + parseInt(data.predict[data.predict.length - 1]),
                }],
            }, {
                labelOptions: {
                    backgroundColor: 'rgba(255,255,255,0.5)',
                    verticalAlign: 'top',
                    y: 5,
                    x: -90
                },
                labels: [{
                    staggerLines: 3,
                    point: {
                        xAxis: 0,
                        yAxis: 2,
                        x: maxIndex + 1958,
                        y: data.技术成果[maxIndex],
                    },
                    text: (maxIndex + 1958) + '年<br>' + '技术成果:' + data.技术成果[maxIndex],
                }],
            }, {
                labelOptions: {
                    backgroundColor: 'rgba(255,255,255,0.5)',
                    verticalAlign: 'top',
                    y: 5,
                    x: 0
                },
                labels: [{
                    staggerLines: 3,
                    point: {
                        xAxis: 0,
                        yAxis: 1,
                        x: maxIndex2 + 1958,
                        y: parseInt(data.diff[maxIndex2]),
                    },
                    text: (maxIndex2 + 1958) + '年<br>' + '论文增长量:' + parseInt(data.diff[maxIndex2]),
                }],
            }],
        });
    }

    //趋势预测
    function printPredictLabel2(data, field, country) {


        // 准备数据
        var result = [];
        var greens = [];
        var blues = [];
        var red1 = {};
        red1["name"] = "历史统计值";
        red1["data"] = data.red1;
        red1["color"] = "#FF0000";
        red1["marker"] = {radius: 2}
        //red1["symbol"] = "circle";
        // serialChart2.addSeries(red1)
        for (var i = 1; i < 6; i++) {
            var blue = {};
            blue["name"] = "未来预测值";
            var num = eval('data.blue' + i);
            console.log(num);
            blue["data"] = num;
            blue["color"] = "#005eff";
            var type = {radius: 2};
            type["symbol"] = "circle";
            blue["marker"] = type;
            var zone = [];
            var tmp = {};
            tmp["value"] = 2024;
            tmp["dashStyle"] = 'ShortDot';
            zone.push(tmp);
            blue["zones"] = zone;
            if (i != 1) {
                blue["showInLegend"] = false;
            }
            blues.push(blue);
            result.push(blue);
            // serialChart2.addSeries(blue);
        }

        for (var i = 1; i < 9; i++) {
            var green = {};
            green["name"] = "历史预测值";
            var num = eval('data.green' + i);
            console.log(num);
            green["data"] = num;
            green["color"] = "#00ff22";
            //green["symbol"] = "circle";
            var zone = [];
            var tmp = {};
            tmp["value"] = 2024;
            tmp["dashStyle"] = 'ShortDot';
            var type = {radius: 2};
            type["symbol"] = "diamond";
            green["marker"] = type;
            zone.push(tmp);
            green["zones"] = zone;
            greens.push(green)
            result.push(green);
            if (i != 1) {
                green["showInLegend"] = false;
            }
            // serialChart2.addSeries(green);
        }

        var tag = 0

        var greenAll = {}
        greenAll["name"] = "预测趋势曲线"
        var blue5 = data.blue5.slice(data.blue5.length - 5, data.blue5.length)
        greenAll["data"] = data.green_all.concat(blue5)
        greenAll["color"] = "#ff8c00"
        greenAll["animation"] = {
            duration: 5000
        }
        var zone = [];
        var tmp = {};
        tmp["value"] = 2024;
        zone.push(tmp);
        greenAll["zones"] = zone;
        var serialChart2 = Highcharts.chart('predict_div2', {
            credits: {
                enabled: false  //去除highcharts版权信息
            },
            chart: {
                animation: false
            },
            title: {
                text: country + field + '领域发展趋势预测图'
            },
            colors: ['#c70831', 'rgba(0,201,66,0.97)', 'rgba(0,171,201,0.97)',
                'rgba(214,229,6,0.97)', 'rgba(118,57,220,0.97)', 'rgba(198,105,35,0.97)'],
            subtitle: {
                text: ''
            },
            xAxis: {
                tickInterval: 1,
            },
            yAxis: {
                title: {
                    text: '科技研发实力'
                }
            },
            legend: {
                enabled: true,
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'middle'
            },
            plotOptions: {
                series: {
                    label: false,
                    pointStart: 2000,
                    animation: {
                        duration: 3000
                    },
                    events: {
                        legendItemClick: function () {
                            if (tag == 0) {
                                for (var i = 1; i < 14; i++) {
                                    serialChart2.series[i].hide()
                                }
                                tag = 1
                            } else {
                                for (var i = 1; i < 14; i++) {
                                    serialChart2.series[i].show()
                                }
                                tag = 0
                            }
                            return false
                        }
                    }
                }
            },
            series: [red1].concat(greens, blues, greenAll),
            responsive: {
                rules: [{
                    condition: {
                        maxWidth: 500
                    },
                    chartOptions: {
                        legend: {
                            layout: 'horizontal',
                            align: 'center',
                            verticalAlign: 'bottom'
                        }
                    }
                }]
            },
            // 标注
            annotations: [{
                labelOptions: {
                    backgroundColor: 'rgba(255,255,255,0.5)',
                    verticalAlign: 'top',
                    y: -50,
                    x: -50
                },
                labels: [{
                    point: {
                        xAxis: 0,
                        yAxis: 0,
                        x: 2004,
                        y: red1.data[4],
                    },
                    text: "历史统计曲线",
                },],
            }, {
                labelOptions: {
                    backgroundColor: 'rgba(255,255,255,0.5)',
                    verticalAlign: 'top',
                    y: 30,
                    x: -50
                },
                labels: [{
                    point: {
                        xAxis: 0,
                        yAxis: 0,
                        x: greenAll.data.length - 2 + 2000,
                        y: greenAll.data[greenAll.data.length - 2],
                    },
                    text: "趋势预测曲线",
                }
                ],
            }
            ]
        });

        setTimeout(function () {
            for (var i = 1; i < 14; i++) {
                serialChart2.series[i].hide()
            }
            tag = 1
        }, 6000)

        result.push(red1);
        console.log("resultData=" + result);
    }

</script>
<script type="text/javascript">

    /* function showRela(data) {
         var myChart = echarts.init(document.getElementById('predict_div'));
         //echarts表格
         myChart.setOption({
             title: {
                 text: '趋势预测',
             },
             subtitle: {
                 text: 'ADE出品，必属精品'
             },
             yAxis: {
                 title: {
                     text: '论文数量'
                 }
             },
             legend: {
                 layout: 'vertical',
                 align: 'right',
                 verticalAlign: 'middle'
             },
             plotOptions: {
                 series: {
                     label: {
                         connectorAllowed: false
                     },
                     pointStart: 2010
                 }
             },
             xAxis: {
                 type: 'category',
                 data: [2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024],
             },
             series: [{
                 name: '论文数量',
                 type: 'line',
                 data: data.values,
             }]
         });

     }*/

    $(document).ready(function () {
    });


</script>
</body>
</html>


<!--
<script>
    function duibi() {
        var start = localStorage.getItem("start");
        var end = localStorage.getItem("end");
        var firstScope = localStorage.getItem("firstScope");
        var country = localStorage.getItem("country");

        var report = {
            "start": start,
            "end": end,
            "firstScope": firstScope,
            "country":country,
        }

        $.ajax({
            url: "http://127.0.0.1:7450/detail",
            method: 'POST',
            dataType: 'jsonp',
            jsonp: "callback",
            jsonpCallback: "successCallback",//回调方法
            contentType: 'application/json',
            data: {
                'field_name': "AI",
                'country_list': JSON.stringify(['中国', '美国', '俄罗斯', '法国', '英国']),
                'start_year': 2016,
                'end_year': 2019
            },
            success: function (data) {
                alert(data);
                $("#detail").html(data);
            },
            error: function () {
                alert("请求失败");
            },
        });
    }

    function xuri() {
        var start = localStorage.getItem("start");
        var end = localStorage.getItem("end");
        var firstScope = localStorage.getItem("firstScope");
        var country = localStorage.getItem("country");

        var report = {
            "start": start,
            "end": end,
            "firstScope": firstScope,
            "country":country,
        }

        $.ajax({
            url: "http://127.0.0.1:7450/sunburst",
            method: 'POST',
            dataType: 'jsonp',
            jsonp: "callback",
            jsonpCallback: "successCallback",//回调方法
            contentType: 'application/json',
            data: {
                'field_name': "AI",
                'country_list': JSON.stringify(['中国', '美国', '俄罗斯', '法国', '英国']),
                'start_year': 2010,
                'end_year': 2019
            },
            success: function (data) {
                var datas =JSON.parse(data);
                var arr = [];
                for(var i=0;i<datas.length;i++){
                    console.log(datas[i]);
                    var jsonStr = JSON.stringify(datas[i]);       //转为JSON字符串
                    console.log(jsonStr);
                    var jsObject = JSON.parse(jsonStr);    //转换为json对象
                    console.log(jsObject);
                    arr.push(jsObject);
                }
                printSunShine(arr);
                console.log(arr);
            }
        });
    }

    function printSunShine(data) {
        Highcharts.setOptions({
            lang: {
                thousandsSep: ',',
                turboThreshold: 2000
            }
        });
        Highcharts.getOptions().colors.splice(0, 0, 'transparent');
        Highcharts.chart('sunshine', {
                chart: {
                    height: '100%'
                },

                title: {
                    text: '军事实力对比体系'
                },
                subtitle: {
                    text: '指标一'
                },
                series: [{
                    type: "sunburst",
                    data: data,
                    allowDrillToNode: true,
                    cursor: 'pointer',
                    dataLabels: {
                        /**
                         * A custom formatter that returns the name only if the inner arc
                         * is longer than a certain pixel size, so the shape has place for
                         * the label.
                         */
                        formatter: function () {
                            var shape = this.point.node.shapeArgs;

                            var innerArcFraction = (shape.end - shape.start) / (2 * Math.PI);
                            var perimeter = 2 * Math.PI * shape.innerR;

                            var innerArcPixels = innerArcFraction * perimeter;

                            if (innerArcPixels > 16) {
                                return this.point.name;
                            }
                        }
                    },
                    levels: [{
                        level: 2,
                        colorByPoint: true,
                        dataLabels: {
                            rotationMode: 'parallel'
                        }
                    },
                        {
                            level: 3,
                            colorVariation: {
                                key: 'brightness',
                                to: -0.5
                            }
                        }, {
                            level: 4,
                            colorVariation: {
                                key: 'brightness',
                                to: 0.5
                            }
                        }]

                }],
                tooltip: {
                    headerFormat: "",
                    pointFormat: '<b>{point.name}</b>的得分为：<b>{point.value}</b>'
                }
            }
        )
    }

    function showBarChart() {
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('barChart'));

        // 指定图表的配置项和数据
        var option = {
            title: {
                text: '中东地区网络攻防资金投入'
            },
            tooltip: {},
            legend: {
                data:['销量']
            },
            xAxis: {
                data: ["衬衫","羊毛衫","雪纺衫","裤子","高跟鞋","袜子"]
            },
            yAxis: {},
            series: [{
                name: '销量',
                type: 'bar',
                data: [5, 20, 36, 10, 10, 20]
            }]
        };
        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
    }

    function showLineChart(){
        // 基于准备好的dom，初始化echarts实例
        var myChart = echarts.init(document.getElementById('lineChart'));
        // 指定图表的配置项和数据
        option = {
            title:{
                text: '中东地区网络攻防投入资金变化'
            },
            xAxis: {
                type: 'category',
                data: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']
            },
            yAxis: {
                type: 'value'
            },
            series: [{
                data: [820, 932, 901, 934, 1290, 1330, 1320],
                type: 'line',
                smooth: true
            }]
        };
        // 使用刚指定的配置项和数据显示图表。
        myChart.setOption(option);
    }

    $(function () {
        showBarChart();
        showLineChart();
        xuri();
        duibi();
    })
</script>
</body>
</html>-->
